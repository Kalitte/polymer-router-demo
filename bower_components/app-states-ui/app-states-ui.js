!function(){function t(t){if(!t.ctrlKey&&!t.metaKey&&2!==t.which){window.history.pushState(this.getAttribute("stateId"),this.getAttribute("title"),this.getAttribute("href"));try{var e=new PopStateEvent("popstate",{bubbles:!1,cancelable:!1,state:window.history.state});"dispatchEvent_"in window?window.dispatchEvent_(e):window.dispatchEvent(e)}catch(a){var i=document.createEvent("CustomEvent");i.initCustomEvent("popstate",!1,!1,{state:window.history.state}),window.dispatchEvent(i)}t.preventDefault()}}Polymer("states-anchor",{ready:function(){},observe:{stateId:"setHref",stateUrl:"setHref",params:"setHref"},setHref:function(){var e;if(this.stateId)e=window.AppStates.getStateById(this.stateId);else{if(!this.stateUrl)return;e=window.AppStates.matchState(this.stateUrl)}if(e){var a=window.AppStates.getInstance(),i=e.buildUrl(this.params),s=a.getCurrentMode();"pushstate"!=s?this.setAttribute("href","pushstate"!=s?"#"+i:i):(this.setAttribute("href",a.virtualPath+i),this.addEventListener("click",t,!1))}else this.setAttribute("href","")}})}(),Polymer("states-menu",{showRoot:!1,trackStateChange:function(t){this.async(function(t){var e=t.detail.currentState,a=this.shadowRoot.querySelectorAll("core-menu /deep/ [state]");[].map.call(a,function(t){for(var a=e;a;){if(t.getAttribute("state")===a.id)if("CORE-SUBMENU"==t.tagName)t.active||(t.active=!0,t.activate());else if("CORE-ITEM"==t.tagName){var i=t.parentElement;i.selected=i.items.indexOf(t)}a=a.parentState}}.bind(this))},t)},attached:function(){document.addEventListener("app-state-changed",this.trackStateChange.bind(this))},detached:function(){document.removeEventListener("app-state-changed",this.trackStateChange.bind(this))},ready:function(){this.menuItems=[],this.root=window.AppStates.getRootState()},rootChanged:function(){this.root&&this.loadMenu()},loadMenu:function(){var t=this.menuItems=[],e=window.AppStates.util,a=this,i=function(s,n){for(var r=0;r<s.length;r++){var o=s[r];if(!a.ignoreAttr||!(o.hasAttribute(a.ignoreAttr)||o.parentNode&&o.parentNode.hasAttribute(a.ignoreAttr))){var h={title:o.header,path:o.url,state:o.id,selected:a.menuItemSelected};n?(n.subItems=n.subItems||[],n.subItems.push(h)):t.push(h),i(e.directChildren(o,"app-state"),h)}}};i(window.AppStates.util.directChildren(this.root,"app-state"))}});